거의 2시간 걸린거같다..하..

첫 step1부터 막힐줄은 몰랐다.
문제 다운을 받으면 index.php 파일과 step2.php파일을 받게 된다.
index.php파일은 말 그대로 뼈대일 뿐이다.
그래서 step2.php코드를 보니 step1에 로그인 하는 부분이 나온다
35번째줄 코드와 36번줄을 보면
$name = preg_replace("/nyang/i", "", $input_name);
$pw = preg_replace("/\d*@\d{2,3}(31)+[^0-8"]!/", "d4y0r50ng", $input_pw);

이런 코드가 보인다

/i는 찾아보니 대소문자를 무시하고 확인하는것같다.
preg_replace는 nyang이라는 문자가 보이면 삭제를 하는것 같다.

비밀번호쪽은 정규식에 맞춰서 일단 넣어보면 된다
1@22319!
^0-8은 0~8을 넣지 말라는것같다.
38번째줄 코드를 보면

if ($name === "dnyang0310" && $pw === "d4y0r50ng+1+13") {

이 코드가 보인다

아이디는 dnyang0310 패스워드는 d4y0r50ng+1+13

근데 31번째 32번째 줄 코드를 보면
if (preg_match("/[a-zA-Z]/", $input_pw)) {
echo "alphabet in the pw :(";
패스워드 필터가 되어있다
소문자,대문자 영어가 들어가면 패스워드가 틀리다고 나오게 되는것이다.

일단 아이디쪽부터 해결을 해보면

dnyang0310 이게 들어가야되는데 nyang을 삭제하기때문에

처음엔 이게 맞겠지 싶어서 dnyangnyang0310 을 넣었다.
하지만 nyang이 두번 들어가면 하나만 지워진다고 생각해버렸다.
이것만 해결하는데 20분정도 소요 되었다..
그래서 해결한 방법은
dnnyangyang0310 이런식으로 nyang 중간 어딘가에 nyang을 넣으면 하나만 삭제가 되어
sumit을 했을때 dnyang0310이 들어간다.
다음은 패스워드이다.

$pw = preg_replace("/\d*@\d{2,3}(31)+[^0-8"]!/", "d4y0r50ng",
이 코드를 보면 정규식에 맞춰 넣으면 d4y0r50ng 이 들어간다.
일딴 정규식에 맞게 넣어서 1@22319! 이렇게 넣어본다.
아까 말한 38번째 코드를 보면 패스워드칸은 d4y0r50ng+1+13 이렇게 되어있다.
정규식에 맞춰서 sumit을 하면 d4y0r50ng 자동으로 패스워드에 들어가게 되는데 뒤에 +1+13이 없어서
1@22319!+1+13을 직접 넣어주면 step1을 풀게된다.

마지막 step2는 생각보다 간단했다.
코드를 보면 cmd라고 적혀있기에 이곳은 리눅스라고 생각하고 ls을 넣었더니
index.php와 step.php가 보인다.
이제 flag를 찾을 때가 왔다..
내가 있는 위치를 확인해보니 나는 /var/www/html 에 있었다.
그래서 ls -l /var/www 를 넣어보니 dream이라는 폴더와 html폴더가 있었다.
ls -l /var/www/dream 을 넣으니 flag.txt파일이 보였지만

54번째줄 코드를 보면
else if (preg_match("/flag/i", $cmd)) {
echo "<pre>Error!</pre>";
}

flag라는 필터가 있다..
flag를 넣으면 에러가 난다.
하지만 저번에 문제 풀었던것처럼 풀면 된다.
?와 * 둘중 하나를 이용한다.
나는 cat /var/www/dream/*.txt를 넣어서
flag를 획득하였다.
